# Rime schema
# encoding: utf-8
 

---

schema:  # è¼¸å…¥æ³•æ–¹æ¡ˆ
  schema_id: hanlo  # è¼¸å…¥æ³•ID
  name: æ¼¢ç¾…  # è¼¸å…¥æ³•åç¨±
  version: "1.2.0"  # ç‰ˆæœ¬è™Ÿç¢¼
  description: å°ç¾…è¼¸å…¥æ³•
  author:
    - splitline
  dependencies:
    - melt_eng

# [kh][ng]ert[oo]uiop
# as[th][ph]ghjkl
# [ts][tsh]c[nn]bnm


switches:
  - name: emoji
    states: [ ğŸ˜´, ğŸ˜„ ]
    reset: 1
  - name: lomaji
    states: ['æ¼¢', 'LÃ´']
    reset: 0
  - name: poj
    states: ['TL', 'POJ']


engine:
  processors:
    - recognizer
    - key_binder
    - speller
    - punctuator
    - selector
    - navigator
    - express_editor

  segmentors:
    - matcher
    - abc_segmentor
    - punct_segmentor
    - fallback_segmentor

  translators:
    - punct_translator
    - table_translator@custom_phrase  # è‡ªè¨‚èªå¥
    - table_translator@melt_eng
    - script_translator

  filters:
    - lua_filter@*pre_lomaji
    - lua_filter@*poj
    - lua_filter@*reorder
    - simplifier@emoji
    - lua_filter@*emoji
    - uniquifier
    - lua_filter@*lomaji
    - lua_filter@*autocap_filter

emoji:
  option_name: emoji
  opencc_config: emoji.json
  inherit_comment: false

punctuator:  # è¨­å®šæ¨™é»ç¬¦è™Ÿè¡¨
  import_preset: hanlo.symbol

menu:
  page_size: 10


speller:
  alphabet: 'abcdefghijklmnopqrstuvwxyzZYXWVUTSRQPONMLKJIHGFEDCBA1234567890 '
  initials: 'abcdefghijklmnopqrstuvwxyzZYXWVUTSRQPONMLKJIHGFEDCBA'
  # finals: "123456789qwzx "
  use_space: true
  auto_select: false
  delimiter: " -"
  algebra:

    # æœƒç•¶ç”¨ POJ ä¾†æ‹
    - derive/^ts/ch/
    - derive/ua/oa/
    - derive/ue/oe/
    - derive/ik/ek/
    - derive/ing/eng/

    # ç‰¹æ®Šæ‹¼æ³•

    - derive/^tsh/x/
    - derive/^ts/z/
    - derive/^kh/q/
    - derive/^th/d/
    - derive/^ph/f/
    - derive/oo/y/
    - derive/ng/w/
    - derive/nn(h?\d)$/v$1/

    # # éŸ³è®Š
    # - derive/ia/e/
    # - derive/ia/ie/


    # ç„¡è²èª¿è¼¸å…¥
    # - derive/h([48])$/$1/
    - derive/[1-9]$//

    # ç°¡æ‹¼
    - abbrev/^([ptkhbgjmnlsxzqdf])(?![hs]).+/$1/
    - abbrev/^([ptk]h).+/$1/
    - abbrev/^(ts)(?!h).+/$1/
    - abbrev/^(tsh).+/$1/

    - derive/^([a-z]+)/\U$1/ # FULLCAP
    - derive/^([a-z])/\U$1/ # Firstcap


translator:
  dictionary: hanlo
  initial_quality: 0
  spelling_hints: 5
  initial_quality: 1.2
  always_show_comments: true
  comment_format:
    # Capitalization is controlled by Lua.
    - xlit ABCDEFGHIJKLMNOPQRSTUVWXYZ abcdefghijklmnopqrstuvwxyz

    - xform/\bx/tsh/
    - xform/\bz/ts/
    - xform/\bq/kh/
    - xform/\bd/th/
    - xform/\bf/ph/
    - xform/y/oo/
    - xform/w/ng/
    - xform/v(h)?(\d)?\b/nn$1$2/

    - xform ([aeiou])(r?)(n[ng]?|m)?([ptkh])?(\d) $1$5$2$3$4
    - xform ([mn])(g)?(h)?(\d) $1$4$2$3
    - xform ([ao])([iuo])(\d) $1$3$2
    - xform (.)[14] $1
    - xform a7 Ä
    - xform a2 Ã¡
    - xform a8 aÌ
    - xform a3 Ã 
    - xform a5 Ã¢
    - xform a9 aÌ‹
    - xform a6 Ç
    - xform e7 Ä“
    - xform e2 Ã©
    - xform e8 eÌ
    - xform e3 Ã¨
    - xform e5 Ãª
    - xform e9 eÌ‹
    - xform e6 Ä›
    - xform i7 Ä«
    - xform i2 Ã­
    - xform i8 iÌ
    - xform i3 Ã¬
    - xform i5 Ã®
    - xform i9 iÌ‹
    - xform i6 Ç
    - xform o7 Å
    - xform o2 Ã³
    - xform o8 oÌ
    - xform o3 Ã²
    - xform o5 Ã´
    - xform o9 Å‘
    - xform o6 Ç’
    - xform u7 Å«
    - xform u2 Ãº
    - xform u8 uÌ
    - xform u3 Ã¹
    - xform u5 Ã»
    - xform u9 Å±
    - xform u6 Ç”
    - xform m7 mÌ„
    - xform m2 á¸¿
    - xform m8 mÌ
    - xform m3 mÌ€
    - xform m5 mÌ‚
    - xform m9 mÌ‹
    - xform m6 mÌŒ
    - xform n7 nÌ„
    - xform n2 Å„
    - xform n8 nÌ
    - xform n3 Ç¹
    - xform n5 nÌ‚
    - xform n9 nÌ‹
    - xform n6 Åˆ

  __comment_format_poj:
    - xform/\bts/ch/

    # uÃ¡ Ã³a
    - xform/[ou]Ã¡/Ã³a/
    - xform/[ou]Ã /Ã²a/
    - xform/[ou]Ã¢/Ã´a/
    - xform/[ou]Ä/Åa/
    - xform/[ou]Ç/Ç’a/
    - xform/[ou]aÌ‹/Å‘a/
    - xform/[ou]a/oa/
    
    # uÃ© Ã³e
    - xform/[ou]Ã©/Ã³e/
    - xform/[ou]Ã¨/Ã²e/
    - xform/[ou]Ãª/Ã´e/
    - xform/[ou]Ä“/Åe/
    - xform/[ou]Ä›/Ã´e/
    - xform/[ou]eÌ‹/Å‘e/
    - xform/ue/oe/
    
    # iÌk eÌk
    - xform/iÌk/eÌk/
    - xform/ik/ek/
    
    # Ã­ng Ã©ng
    - xform/Ã­ng/Ã©ng/
    - xform/Ã¬ng/Ã¨ng/
    - xform/Ã®ng/Ãªng/
    - xform/Ä«ng/Ä“ng/
    - xform/Çng/Ä›ng/
    - xform/iÌ‹ng/eÌ‹ng/
    - xform/ing/eng/
    
    # Ã³o Ã³Í˜
    - xform/Ã³o/oÍ˜Ì/
    - xform/Ã²o/oÍ˜Ì€/
    - xform/Ã´o/oÍ˜Ì‚/
    - xform/Åo/oÍ˜Ì„/
    - xform/Ç’o/oÍ˜ÌŒ/
    - xform/Å‘o/oÍ˜Ì‹/
    - xform/oo/oÍ˜/
    
    - xform/nn(h)?\b/â¿$1/
  preedit_format:
    - xform/\bx/tsh/
    - xform/\bX([A-Z])/TSH$1/
    - xform/\bX([a-z])?/Tsh$1/
    - xform/\bz/ts/
    - xform/\bZ([A-Z])/TS$1/
    - xform/\bZ([a-z])?/Ts$1/
    - xform/\bq/kh/
    - xform/\bQ([A-Z])/KH$1/
    - xform/\bQ([a-z])?/Kh$1/
    - xform/\bd/th/
    - xform/\bD([A-Z])/TH$1/
    - xform/\bD([a-z])?/Th$1/
    - xform/\bf/ph/
    - xform/\bF([A-Z])/PH$1/
    - xform/\bF([a-z])?/Ph$1/

    - xform/y/oo/
    - xform/\bY/Oo/
    - xform/Y/OO/
    - xform/w/ng/
    - xform/\bW/Ng/
    - xform/W/NG/
    - xform/v(h)?(\d)?\b/nn$1$2/
    - xform/V(H|h)?(\d)?\b/NN$1$2/


custom_phrase:
  dictionary: ""
  user_dict: hanlo.custom_phrase
  db_class: tabledb
  enable_completion: false
  enable_sentence: false
  initial_quality: 99 


melt_eng:
  dictionary: melt_eng
  enable_sentence: false
  enable_user_dict: false
  initial_quality: 1.1
  comment_format:
    - xform/.*//

key_binder:
  bindings:
    - {accept: "Shift+space", toggle: lomaji, when: always}
    - {accept: "Control+l", toggle: lomaji, when: always}

navigator:
  bindings:
    "Alt+Left": left_by_syllable
    "Alt+Right": right_by_syllable
    Left: left_by_char

editor:
  bindings:
    "Shift+Delete": delete_candidate
    "Alt+Delete": back_syllable
    
    "Shift+Return": commit_comment
    Return: confirm

