# Rime schema
# encoding: utf-8
#
#

# modify from: https://github.com/YuRen-tw/rime-taigi-tps
---
schema:  # Ëº∏ÂÖ•Ê≥ïÊñπÊ°à
  schema_id: taigi_bophomo  # Ëº∏ÂÖ•Ê≥ïID
  name: Âè∞Ë™û„Ü†„ÑÜ„Ñá  # Ëº∏ÂÖ•Ê≥ïÂêçÁ®±
  version: "1.2.0"  # ÁâàÊú¨ËôüÁ¢º
  description: Âè∞Ë™û„Ü†„ÑÜ„ÑáËº∏ÂÖ•Ê≥ï
  author:
    - splitline


switches:
  - name: ascii_mode
    reset: 0
    states: [ Âè∞Êñá, ABC ]
  - name: emoji
    states: [ üò¥, üòÑ ]
    reset: 1
  - name: full_shape
    reset: 0
    states: [ ÂçäÂΩ¢, ÂÖ®ÂΩ¢ ]

engine:
  processors:
    - ascii_composer
    - recognizer
    - key_binder
    - speller
    - punctuator
    - selector
    - navigator
    - express_editor
  segmentors:
    - ascii_segmentor
    - matcher
    - abc_segmentor
    - punct_segmentor
    - fallback_segmentor
  translators:
    - table_translator@custom_phrase
    - punct_translator
    - script_translator
    
  filters:
    - lua_filter@*reorder
    - simplifier@emoji
    - lua_filter@*emoji
    - lua_filter@*tsu_im
    - uniquifier

emoji:
  option_name: emoji
  opencc_config: emoji.json
  inherit_comment: false

menu:
  alternative_select_keys: "QWERASDZXC"
  page_size: 10

punctuator:
  # „ÑÖ„ÑÜ„Ñá„Ü†„Ñâ„Ñä„Ñã„Ñå„Ñç„Ñé„Ñè„Ñê„Ñë„Ñí„Ü£„Ñ´„Ü°„Ñó„Ñò„Ñô„Ñß„Ñ®„Ü¨„Ñö„Ü¶„Ñú„Ü∞„Ñû„Ü§„Ñ†„Ü≤„Ñ¢„Ñ£„Ñ§„Ñ•„Ü≠ÀãÀ™ÀäÀ´Ôºé
  full_shape: &symbols
    '1': ['„ÑÖ','„Ü¥']
    'q': '„ÑÜ'
    'a': '„Ñá'
    'z': '„Ü†'
    '2': ['„Ñâ', '„Üµ']
    'w': '„Ñä'
    's': '„Ñã'
    'x': '„Ñå'
    '3': 'À™'
    'e': ['„Ñç', '„Üª']
    'd': '„Ñé'
    'c': ['„Ñè', '„Ü∑']
    '4': 'Àã'
    'r': '„Ñê'
    'f': '„Ñë'
    'v': '„Ñí'
    '5': 'À´'
    't': '„Ü£'
    'g': '„Ñ´'
    'b': ['„Ü°', '„Ü¢']
    '6': 'Àä'
    'y': '„Ñó'
    'h': '„Ñò'
    'n': '„Ñô'
    '7': 'Ôºé'
    'u': ['„Ñß','„Ü™']
    'j': ['„Ñ®','„Ü´','„Ü®']
    'm': '„Ü¨'
    '8': ['„Ñö','„Ü©']
    'i': ['„Ü¶', '„Üß']
    'k': '„Ñú'
    ',': ['„Ü∞', '„Ü±']
    '9': ['„Ñû', '„ÜÆ']
    'o': ['„Ü§', '„Ü•', '„Ñù']
    'l': ['„Ñ†', '„ÜØ']
    '.': '„Ü≤'
    '0': '„Ñ¢'
    'p': '„Ñ£'
    ';': '„Ñ§'
    '/': '„Ñ•'
    '-': '„Ü≠'
  half_shape: *symbols

speller:
  alphabet: '1qaz2wsxedcrfvtgbyhnujm8ik,9ol.0p;/- 43657'
  initials: '1qaz2wsxedcrfvtgbyhnujm8ik,9ol.0p;/-7'
  finals: ' 43567'
  delimiter: "'"
  use_space: true
  algebra:
    # ===== TL -> TPS =====
    - xform/h?[48]/0/  # ÂÖ•ËÅ≤Ë™øÔºàÁ¨¨ÂõõË™ø„ÄÅÁ¨¨ÂÖ´Ë™øÔºâÂêà‰Ωµ
    - xform/9/5/  # Á¨¨‰πùË™øÂêà‰ΩµÂà∞Á¨¨‰∫îË™ø
    - xform/6/2/  # Á¨¨ÂÖ≠Ë™øÂêà‰ΩµÂà∞Á¨¨‰∫åË™ø

    # ËΩâÊèõËÅ≤ÊØç (initial parts)
    - xform/^ts/c/ # ts -> „Ñó„Ñê / „Ñë„Ñò
    - xform/^([ptkc])h/\u$1/ # „ÑÜ„Ñä„Ñé(„Ñë„Ñò)
    - xform/^ng(\D+)/q$1/ # „Ñ´
    - xform/^j/z/ # „Ü°

    # „Ü¢„Ñê„Ñë„Ñí / „Ü°„Ñó„Ñò„Ñô
    - xform/^ci/ji/  # „Ñê„Ñß
    - xform/^Ci/Ji/  # „Ñë„Ñß
    - xform/^si/Si/  # „Ñí„Ñß

    # ËΩâÊèõÈüªÊØç (final parts)
    - xform/nnh?(\d)/N$1/ # ÈºªÈü≥

    - xform/o(k|p|m|ng|Nh?)/oo$1/ # it's actually `oo`
    - xform/(?<!o)o(?!o)/√∏/ # „Ñú
    - xform/oo/o/ # real „Ñõ

    - xform/[mp](\d)/B$1/
    - xform/(i?[aoi])(k|ng)/$1G/
    - xform/ng/R/ # „Ü≠
    - xform/([ieu]?[iuar])[nt]/$1D/

    # ÁâπÊÆäËÖîÂè£
    - xform/ir/y/
    - xform/er/√ò/
    - xform/ee/E/
    
    - derive/y/u/  # „Ü®=„Ñ®
    - derive/√ò/√∏/  # „Ñú
    - derive/E/e/  # „Ñù=„Ü§
    

    # ===== features =====

    - derive/iaD/ieD/  # „Ñß„Ñ¢„ÄÅ„Ñß„Ñö„Üµ ‚Üí „Ñß„Ñ¢„ÄÅ„Ñß„Ü§„Üµ
    - derive/ieD/eD/   # „Ñß„Ñ¢„ÄÅ„Ñß„Ü§„Üµ ‚Üí „Ü§„Ñ£„ÄÅ„Ü§„Üµ

    # Ê≥®Èü≥
    - derive/√∏G/G/  # Áî® „Ñß„Ü≠ ‰æÜÊãç „Ñß„Ñ•Ôºà‰ΩµÂÖ•Ôºâ
    - derive/(?<!i)oG/uG/  # Áî® „Ñ®„Ü≠ÔºàÊ≥®Èü≥ÁöÑ „Ñ®„Ñ•Ôºâ‰æÜÊãç „Ü≤
    - derive/ioG/BG/       # Áî® „Ü¨„Ü≠ÔºàÊ≥®Èü≥ÁöÑ „Ñ©„Ñ•Ôºâ‰æÜÊãç „Ñß„Ü≤
    # ÂÖ•ËÅ≤Ë™ø
    - derive/([iao])B0/$1p0/   # Áî® „Ñö„ÑÖÔºé ‰æÜÊãç „Ñö„Ü¥
    - derive/([iuae])D0/$1t0/  # Áî® „Ñö„ÑâÔºé ‰æÜÊãç „Ñö„Üµ
    - derive/([iao√∏])G0/$1k0/  # Áî® „Ñö„ÑçÔºé ‰æÜÊãç „Ñö„Üª
    # ÊñπÈü≥ÈüªÊØç
    - derive/oB/aB/  # „Ü¶„Ü¨„ÄÅ„Ü∞Ôºà‰ΩµÂÖ•Ôºâ
    - derive/aB/M/   # „Ñö„Ü¨„ÄÅ„Ü∞
    - xform/aD/L/    # „Ñ¢
    - xform/aG/Q/    # „Ñ§
    - xform/ai/I/    # „Ñû
    - xform/au/U/    # „Ñ†
    - derive/oG/Y/   # „Ü¶„Ü≠„ÄÅ„Ü≤
    - derive/R/G/    # „Ü≠ = „Ñ•

    - derive/([iuaoeIU])N/$1$1/     # ÊãçÂÖ©Êì∫ÈüªÊØç‰æÜÊãçÈºªÈü≥
    # Á∞°Êãº
    # - abbrev/[iu]?[iuaoeIU]N/N/  # Áî® ÔΩé ‰ª£Ë°®ÊâÄÊúâÁöÑÈºªÈü≥ÊØçÈü≥
    # - abbrev/[iuao√∏eIUMLQYBDG]+0/0/  # Áî® Ôºé ‰ª£Ë°®ÊâÄÊúâÁöÑÂÖ•ËÅ≤ÈüªÊØç
    - abbrev/^([pPbmtTlnkKgqcCzsjJSh]).+$/$1/  # ÊúÉÁï∂Âπ≤ÁÑ¶ÊãçËÅ≤ÊØç
    - abbrev/^(\D+)([123579])$/$1/  # Èô§‰∫ÜÁ¨¨ÂõõË™ø„ÄÅÁ¨¨ÂÖ´Ë™øÔºåË™øËôüÊúÉÁï∂ÂÖçÊãç
    - abbrev/^([pPbmtTlnkKgqcCzsjJSh]).+(\d)$/$1$2/  # ÊúÉÁï∂Âπ≤ÁÑ¶ÊãçÂ≠êÈü≥+Ë™øËôü
    - xlit|pPmbtTnlkKhjJSgqzcCsiuBao√∏MIeUYLDQGR123570|1qaz2wsxedcrfvtgbyhnujm8ik,9ol.0p;/- 43657|

translator:
  dictionary: hanlo
  prism: taigi_bophomo
  spelling_hints: 5
  always_show_comments: true
  comment_format:
    - xform/'/ /
    - xform/\bts/c/
    - xform/\b([ptkc])h/\u$1/
    - xform/a([iu])/\u$1/
    - xform/\bng(\D+)/q$1/ # „Ñ´
    - xform/\bj/z/ # „Ü°

    - xform/nnh?(\d)/N$1/ # ÈºªÈü≥
    
    - xform/o(k|p|m|ng|Nh?)/oo$1/ # it's actually `oo`
    - xform/(?<!o)o(?!o)/√∏/ # „Ñú
    - xform/oo/o/ # real „Ñõ

    - xform/h(\d)/$1/

    - xform/[mp](\d)/B$1/
    - xform/(i?[aoi])(k|ng)/$1G/
    - xform/ng/R/ # „Ü≠
    - xform/([ieu]?[iuar])[nt]/$1D/

    - xform/ir/y/
    - xform/er/√ò/
    - xform/ee/E/


    - xlit|pPmbtTnlkKhgqcCzsiuao√∏eIUBDRGNy√òE|„ÑÖ„ÑÜ„Ñá„Ü†„Ñâ„Ñä„Ñã„Ñå„Ñç„Ñé„Ñè„Ü£„Ñ´„Ñó„Ñò„Ü°„Ñô„Ñß„Ñ®„Ñö„Ü¶„Ñú„Ü§„Ñû„Ñ†„Ü¨„Ñ£„Ü≠„Ñ•ÔΩé„Ü®„Ñú„Ñù|
    # ÊñπÈü≥Á¨¶ËôüÊúÉÂàÜ „Ü¢„Ñê„Ñë„Ñí Âíå „Ü°„Ñó„Ñò„Ñô
    - xform/„Ñó(„Ñß)/„Ñê$1/
    - xform/„Ñò(„Ñß)/„Ñë$1/
    - xform/„Ü°(„Ñß)/„Ü¢$1/
    - xform/„Ñô(„Ñß)/„Ñí$1/
    # ÂÖ•ËÅ≤Ë™ø
    - xform/(?<=„Ñß|„Ñö|„Ü¶)„Ü¨([48])/„Ü¥$1/
    - xform/(?<=„Ñß|„Ü®|„Ñ®|„Ñö)„Ñ£([48])/„Üµ$1/
    - xform/(?<=„Ñö|„Ü¶|„Ñß)„Ñ•([48])/„Üª$1/
    - xform/(?<!„Ü¥|„Üµ|„Üª)([48])/„Ü∑$1/
    # ÈºªÈü≥
    # - xform/ÔΩé((„Ñß|„Ñ®)?(„Ñß|„Ñ®|„Ñö|„Ü¶|„Ü§|„Ñû|„Ñ†))/$1ÔΩé/
    - xform/„ÑßÔΩé/„Ü™/
    - xform/„Ñ®ÔΩé/„Ü´/
    - xform/„ÑöÔΩé/„Ü©/
    - xform/„Ü¶ÔΩé/„Üß/
    - xform/„Ü§ÔΩé/„Ü•/
    - xform/„ÑûÔΩé/„ÜÆ/
    - xform/„Ñ†ÔΩé/„ÜØ/
    # ÈüªÊØç
    - xform/„Ñö„Ü¨/„Ü∞/
    - xform/„Ü¶„Ü¨/„Ü±/
    - xform/„Ñö„Ñ£/„Ñ¢/
    - xform/„Ñö„Ñ•/„Ñ§/
    - xform/„Ü¶„Ñ•/„Ü≤/
    - xform/„Ñú„Ñ•/„Ñ•/
    # ËÅ≤Ë™ø
    - xlit|1235769|ÀâÀãÀ™ÀäÀ´‚Å∂‚Åπ|
    - xform/4//
    - xform/8/Àô/
  preedit_format:
    - xform/ /Àâ/
    - xform/'/ /
    - xlit|1qaz2wsxedcrfvtgbyhnujm8ik,9ol.0p;/-43657|„ÑÖ„ÑÜ„Ñá„Ü†„Ñâ„Ñä„Ñã„Ñå„Ñç„Ñé„Ñè„Ñê„Ñë„Ñí„Ü£„Ñ´„Ü°„Ñó„Ñò„Ñô„Ñß„Ñ®„Ü¨„Ñö„Ü¶„Ñú„Ü∞„Ñû„Ü§„Ñ†„Ü≤„Ñ¢„Ñ£„Ñ§„Ñ•„Ü≠ÀãÀ™ÀäÀ´Ôºé|
    # ÊãÜÈüªÊØç
    - xform/„Ü∞/„Ñö„Ü¨/
    - xform/„Ñ¢/„Ñö„Ñ£/
    - xform/„Ñ§/„Ñö„Ñ•/
    - xform/„Ü≤/„Ü¶„Ñ•/
    - xform/„Ñ®„Ñ•/„Ü¶„Ñ•/
    - xform/„Ü¨„Ñ•/„Ñß„Ü¶„Ñ•/
    # - xform/„Ñß„Ñ•/„Ñß„Ñú„Ñ•/
    # Âí±ÂÖ± „Ü¢ Âíå „Ü° Âêà‰Ωµ
    - xform/„Ü°„Ñß/„Ü¢„Ñß/
    # ÈºªÈü≥
    - xform/„Ñß(„Ñß|ÔΩé)/„Ü™/
    - xform/„Ñ®(„Ñ®|ÔΩé)/„Ü´/
    - xform/„Ñö(„Ñö|ÔΩé)/„Ü©/
    - xform/„Ü¶(„Ü¶|ÔΩé)/„Üß/
    - xform/„Ü§(„Ü§|ÔΩé)/„Ü•/
    - xform/„Ñû(„Ñû|ÔΩé)/„ÜÆ/
    - xform/„Ñ†(„Ñ†|ÔΩé)/„ÜØ/
    # ÂÖ•ËÅ≤Ë™ø
    - xform/(„Ñß|„Ñö|„Ü¶)(„ÑÖ|„Ü¨)Ôºé/$1„Ü¥/
    - xform/(„Ñß|„Ñ®|„Ñö|„Ü§)(„Ñâ|„Ñ£)Ôºé/$1„Üµ/
    - xform/(„Ñö|„Ü¶|„Ñß)(„Ñç|„Ñ•)Ôºé/$1„Üª/
    - xform/(„Ñß|„Ü™|„Ñ®|„Ü´|„Ñö|„Ü©|„Ü¶|„Üß|„Ñú|„Ü§|„Ü•|„Ñû|„ÜÆ|„Ñ†|„ÜØ|„Ü¨|„Ñ•)Ôºé/$1„Ü∑/
    # ÂêàÈüªÊØç
    - xform/„Ñö„Ü¨/„Ü∞/
    - xform/„Ü¶„Ü¨/„Ü±/
    - xform/„Ñö„Ñ£/„Ñ¢/
    - xform/„Ñö„Ñ•/„Ñ§/
    - xform/„Ü¶„Ñ•/„Ü≤/
    - xform/„Ñú„Ñ•/„Ñ•/

custom_phrase:
  dictionary: ''
  user_dict: custom_phrase
  db_class: stabledb
  enable_completion: false
  enable_sentence: false
  initial_quality: 1


key_binder:
  # import_preset: default
  bindings:
    - { when: has_menu, accept: comma, send: comma }      # „Ü§
    - { when: has_menu, accept: period, send: period }    # „Ü≤
    - { when: has_menu, accept: minus, send: minus }      # „Ü≠


editor:
  bindings:
    "Shift+Delete": delete_candidate
    "Alt+Delete": back_syllable
    
    "Shift+Return": commit_comment
    Return: confirm

recognizer:
  patterns:
    email: ^[a-z][-_.0-9a-z]*@.*$
    uppercase: ^[A-Z][-_+.'0-9A-Za-z]*$
    url: ^(www[.]|https?:|ftp:|mailto:).*$
    punct: '`[^\s]$'
